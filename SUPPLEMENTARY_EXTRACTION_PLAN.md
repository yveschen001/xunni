# 补充提取计划（遗漏的 172 处）

**目标**: 补充提取遗漏的 172 处硬编码中文  
**原则**: 遵循 `I18N_CLEAN_EXTRACTION_PLAN.md` 的提取原则

---

## 📊 遗漏内容分类

### 1. 国家名称（72 处）- 特殊处理

**来源**: `src/utils/country_flag.ts`

**内容示例**:
- `亞塞拜然`、`亞美尼亞`、`以色列`、`伊拉克`、`俄羅斯` 等

**处理方式**:
- **选项 A**: 不提取（使用标准 ISO 国家代码，前端显示时翻译）
- **选项 B**: 提取但标记为"数据映射"，使用标准 key（如 `country.azerbaijan`）
- **选项 C**: 提取到单独的 namespace（`countries.*`）

**建议**: **选项 A 或 B** - 国家名称应该使用标准代码，而不是硬编码中文

---

### 2. 关键内容（18 处）- 必须提取

**类型**:
- 错误/成功消息
- 确认选项（"是"/"否"）
- 命令说明
- 分享链接文本

**提取方式**: 
- ✅ **遵循原计划原则**：完整句子/段落作为一个 key
- ✅ 保持语义完整性
- ✅ 生成语义化 key

**示例**:
```
原始: "✅ 今日廣告已達上限"
Key: "ad.reward.quotaExhausted"
```

---

### 3. 重要内容（60 处）- 建议提取

**类型**:
- 状态标签（"未設定"、"待處理"）
- 提示消息
- 功能标签

**提取方式**:
- ✅ **遵循原计划原则**：保持完整
- ✅ 短文本可以单独提取（如 "未設定"）
- ✅ 生成语义化 key

**示例**:
```
原始: "未設定"
Key: "common.notSet" 或 "status.notSet"
```

---

### 4. 次要内容（22 处）- 可延后

**类型**:
- 短标签（"免費會員"、"VIP 會員 💎"）
- 内部状态值

**提取方式**:
- ✅ 遵循原计划原则
- ⏳ 可以后续处理

---

## 🔧 补充提取方法

### 方法 1: 直接添加到现有提取结果（推荐）

**步骤**:
1. 读取 `not_extracted_strings.json`
2. 过滤掉国家名称（72 处）- 单独处理
3. 将剩余的 100 处添加到 `i18n_complete_final.json`
4. 重新生成 keys
5. 更新 CSV

**优点**:
- ✅ 快速
- ✅ 不影响现有提取结果
- ✅ 可以单独处理国家名称

---

### 方法 2: 重新运行提取脚本（全面但慢）

**步骤**:
1. 改进提取脚本，确保捕获所有内容
2. 重新运行完整提取
3. 合并结果

**优点**:
- ✅ 更全面
- ✅ 可以修复提取逻辑

**缺点**:
- ⏱️ 耗时较长
- ⚠️ 可能影响现有结果

---

### 方法 3: 手动补充（精确但慢）

**步骤**:
1. 查看 `missed_strings_impact_analysis.json`
2. 手动添加关键和重要内容（78 处）
3. 生成 keys
4. 更新 CSV

**优点**:
- ✅ 精确控制
- ✅ 可以筛选真正需要的内容

**缺点**:
- ⏱️ 耗时
- ⚠️ 容易遗漏

---

## 🎯 推荐方案

### 方案：方法 1 + 国家名称特殊处理

**步骤**:

1. **处理国家名称**（72 处）
   - 决定：提取还是不提取？
   - 如果提取：使用标准 key 格式（`countries.*`）
   - 如果不提取：标记为"跳过"

2. **补充关键和重要内容**（78 处）
   - 从 `not_extracted_strings.json` 读取
   - 过滤掉国家名称
   - 添加到现有提取结果
   - 重新生成 keys

3. **更新 CSV**
   - 合并到现有 CSV
   - 或生成新的完整 CSV

---

## ✅ 遵循的原则

### 从 `I18N_CLEAN_EXTRACTION_PLAN.md` 继承：

1. ✅ **保持完整性**：一整个句子或段落作为一个 key
2. ✅ **500 字以内都保持完整**
3. ✅ **只有按钮文字可以单独提取**
4. ✅ **语义化 key 命名**：`<category>.<subcategory>.<action>`
5. ✅ **跳过业务逻辑标识符**（callback_data 等）
6. ✅ **跳过注释和 console.log**

### 特殊情况处理：

1. **国家名称**：使用标准代码或单独 namespace
2. **短标签**（如 "未設定"）：可以单独提取
3. **确认选项**（"是"/"否"）：提取为 `common.yes` / `common.no`

---

## 📋 执行计划

### Phase 1: 决定国家名称处理方式
- [ ] 选项 A：不提取（使用 ISO 代码）
- [ ] 选项 B：提取到 `countries.*` namespace
- [ ] 选项 C：其他方案

### Phase 2: 补充提取关键和重要内容（78 处）
- [ ] 从 `not_extracted_strings.json` 读取
- [ ] 过滤和分类
- [ ] 添加到现有提取结果
- [ ] 生成语义化 keys

### Phase 3: 更新输出文件
- [ ] 更新 `i18n_complete_final.json`
- [ ] 更新 `i18n_keys_mapping_fixed.json`
- [ ] 重新生成 `i18n_for_translation.csv`

### Phase 4: 验证
- [ ] 运行验证脚本
- [ ] 确认覆盖率 100%
- [ ] 确认无遗漏

---

## ❓ 需要确认的问题

1. **国家名称**：提取还是不提取？
   - 如果提取，使用什么 key 格式？
   - 如果提取，是否需要翻译？

2. **次要内容**（22 处）：现在提取还是后续处理？

3. **提取方式**：使用方法 1（推荐）还是其他方法？

---

**总结**: 我会**遵循 `I18N_CLEAN_EXTRACTION_PLAN.md` 的所有原则**，使用**方法 1（直接添加）**来补充提取，但需要你先确认**国家名称的处理方式**。

