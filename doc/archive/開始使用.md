# ğŸš€ é–‹å§‹ä½¿ç”¨æœ¬åœ°é–‹ç™¼ç’°å¢ƒ

## âœ… **ç’°å¢ƒå·²å°±ç·’ï¼**

ä½ çš„æœ¬åœ°é–‹ç™¼ç’°å¢ƒå·²ç¶“é…ç½®å®Œæˆä¸¦æ¸¬è©¦é€šéï¼

---

## ğŸ¯ **ç«‹å³é–‹å§‹ï¼ˆ3 æ­¥é©Ÿï¼‰**

### **æ­¥é©Ÿ 1: å•Ÿå‹• Bot**

```bash
pnpm dev:polling
```

### **æ­¥é©Ÿ 2: æ¸¬è©¦ Bot**

1. æ‰“é–‹ Telegram
2. æ‰¾åˆ°ä½ çš„ Botï¼š`@xunni_staging_bot`
3. ç™¼é€ä»»ä½•æ¶ˆæ¯ï¼ˆä¾‹å¦‚ï¼š`/start`ï¼‰

### **æ­¥é©Ÿ 3: æŸ¥çœ‹è¼¸å‡º**

ä½ æœƒåœ¨çµ‚ç«¯çœ‹åˆ°ï¼š

```
ğŸ“¬ Received 1 update(s) (Total: 1)

ğŸ“¨ Processing update 123456789
   From: Yichen (@yichen)
   Text: /start
âœ… Update processed successfully
```

---

## ğŸŠ **æˆåŠŸï¼**

å¦‚æœä½ çœ‹åˆ°ä¸Šé¢çš„è¼¸å‡ºï¼Œèªªæ˜ä¸€åˆ‡æ­£å¸¸ï¼

ç¾åœ¨ä½ å¯ä»¥ï¼š

### **âœ… é–‹ç™¼æ–°åŠŸèƒ½**

```bash
# 1. å‰µå»ºæ–°æ–‡ä»¶
vim src/telegram/handlers/new_feature.ts

# 2. ç·¨å¯«ä»£ç¢¼
export async function handleNewFeature(...) {
  // ä½ çš„ä»£ç¢¼
}

# 3. é‡å•Ÿ Botï¼ˆCtrl+C ç„¶å¾Œé‡æ–°é‹è¡Œï¼‰
pnpm dev:polling

# 4. åœ¨ Telegram æ¸¬è©¦
```

### **âœ… é–‹ç™¼å»£å‘Šç³»çµ±**

```bash
# 1. è¨­è¨ˆå»£å‘Šæ•¸æ“šçµæ§‹
vim doc/AD_SYSTEM_DESIGN.md

# 2. å¯¦ç¾å»£å‘Šé‚è¼¯
vim src/telegram/handlers/ad.ts

# 3. æ¸¬è©¦å»£å‘Šé¡¯ç¤º
pnpm dev:polling
# åœ¨ Telegram ä¸­è§¸ç™¼å»£å‘Š
```

### **âœ… ä¿®å¾© Bug**

```bash
# 1. é‡ç¾ Bug
pnpm dev:polling
# åœ¨ Telegram ä¸­è§¸ç™¼ Bug

# 2. æŸ¥çœ‹éŒ¯èª¤ä¿¡æ¯
# çµ‚ç«¯æœƒé¡¯ç¤ºè©³ç´°çš„ Stack Trace

# 3. ä¿®å¾©ä»£ç¢¼
vim src/...

# 4. é‡å•Ÿæ¸¬è©¦
pnpm dev:polling
```

---

## ğŸ’¡ **å¸¸ç”¨å‘½ä»¤**

```bash
# å•Ÿå‹•æœ¬åœ°é–‹ç™¼
pnpm dev:polling

# é‹è¡Œæ¸¬è©¦
pnpm test

# æª¢æŸ¥ä»£ç¢¼
pnpm lint

# é¡å‹æª¢æŸ¥
pnpm typecheck

# æŸ¥çœ‹æ•¸æ“šåº«ï¼ˆç•¶ Cloudflare æ¢å¾©å¾Œï¼‰
wrangler d1 execute DB --local --command "SELECT * FROM users LIMIT 10"
```

---

## ğŸ”§ **é–‹ç™¼å·¥ä½œæµç¨‹**

### **å…¸å‹çš„é–‹ç™¼å¾ªç’°ï¼š**

```bash
# 1. å•Ÿå‹• Bot
pnpm dev:polling

# 2. ä¿®æ”¹ä»£ç¢¼
vim src/...

# 3. é‡å•Ÿ Botï¼ˆCtrl+Cï¼‰
pnpm dev:polling

# 4. æ¸¬è©¦ä¿®æ”¹
# åœ¨ Telegram ä¸­æ¸¬è©¦

# 5. é‡è¤‡æ­¥é©Ÿ 2-4
```

### **ç•¶ Cloudflare æ¢å¾©å¾Œï¼š**

```bash
# 1. åœæ­¢ Polling æ¨¡å¼
# æŒ‰ Ctrl+C

# 2. éƒ¨ç½²åˆ° Staging
pnpm deploy:staging

# 3. è¨­ç½® Webhook
curl -X POST "https://api.telegram.org/botä½ çš„TOKEN/setWebhook" \
  -d "url=https://ä½ çš„workeråœ°å€.workers.dev/webhook"

# 4. ç¹¼çºŒæ­£å¸¸é–‹ç™¼
```

---

## ğŸ“š **æ–‡æª”ç´¢å¼•**

- **`æœ¬åœ°é–‹ç™¼ç’°å¢ƒå·²å°±ç·’.md`** - å®Œæ•´çš„é…ç½®èªªæ˜
- **`æœ¬åœ°é–‹ç™¼æŒ‡å—.md`** - è©³ç´°ä½¿ç”¨æŒ‡å—
- **`LOCAL_DEV_QUICK_START.md`** - å¿«é€Ÿé–‹å§‹ï¼ˆè‹±æ–‡ï¼‰
- **`LOCAL_DEVELOPMENT_GUIDE.md`** - å®Œæ•´æŒ‡å—ï¼ˆè‹±æ–‡ï¼‰

---

## âš ï¸ **é‡è¦æç¤º**

### **Polling æ¨¡å¼çš„é™åˆ¶ï¼š**

1. **æ•¸æ“šåº«åŠŸèƒ½å—é™**
   - ä½¿ç”¨ Mock æ•¸æ“šåº«
   - æ•¸æ“šåº«æ“ä½œæœƒå¤±æ•—
   - é©åˆæ¸¬è©¦ Bot é‚è¼¯

2. **ä¸æ”¯æŒç†±é‡è¼‰**
   - ä¿®æ”¹ä»£ç¢¼å¾Œéœ€è¦é‡å•Ÿ
   - æŒ‰ `Ctrl+C` åœæ­¢ï¼Œç„¶å¾Œé‡æ–°é‹è¡Œ

3. **æœƒåˆªé™¤ Webhook**
   - å•Ÿå‹•æ™‚è‡ªå‹•åˆªé™¤ Webhook
   - ç¢ºä¿ä½¿ç”¨é–‹ç™¼ç’°å¢ƒçš„ Bot Token

---

## ğŸ¯ **æ¨è–¦çš„ä¸‹ä¸€æ­¥**

### **é¸é … A: é–‹ç™¼å»£å‘Šç³»çµ±** â­ æ¨è–¦

```bash
# 1. å•Ÿå‹• Bot
pnpm dev:polling

# 2. é–‹å§‹é–‹ç™¼
# - è¨­è¨ˆå»£å‘Šæ•¸æ“šçµæ§‹
# - å¯¦ç¾å»£å‘Šé¡¯ç¤ºé‚è¼¯
# - æ¸¬è©¦å»£å‘Šè¼ªæ’­

# 3. ç­‰ Cloudflare æ¢å¾©å¾Œæ·»åŠ æ•¸æ“šåº«æ”¯æŒ
```

### **é¸é … B: æ¸¬è©¦ç¾æœ‰åŠŸèƒ½**

```bash
# 1. å•Ÿå‹• Bot
pnpm dev:polling

# 2. æ¸¬è©¦å„ç¨®å‘½ä»¤
# /start, /help, /profile, ç­‰ç­‰

# 3. ç¢ºä¿åŸºæœ¬åŠŸèƒ½æ­£å¸¸
```

### **é¸é … C: é‹è¡Œæ¸¬è©¦**

```bash
# é‹è¡Œæ‰€æœ‰æ¸¬è©¦
pnpm test

# é‹è¡Œç‰¹å®šæ¸¬è©¦
pnpm test src/domain/user.test.ts

# æŸ¥çœ‹è¦†è“‹ç‡
pnpm test:coverage
```

---

## ğŸ†˜ **é‡åˆ°å•é¡Œï¼Ÿ**

### **Bot æ²’æœ‰éŸ¿æ‡‰ï¼Ÿ**

```bash
# æª¢æŸ¥ Token
curl "https://api.telegram.org/botä½ çš„TOKEN/getMe"

# æª¢æŸ¥ç’°å¢ƒè®Šæ•¸
cat .dev.vars | grep TELEGRAM_BOT_TOKEN

# é‡å•Ÿ Bot
pnpm dev:polling
```

### **ç’°å¢ƒè®Šæ•¸æœªåŠ è¼‰ï¼Ÿ**

```bash
# ç¢ºèªæ–‡ä»¶å­˜åœ¨
ls -la .dev.vars

# æŸ¥çœ‹å…§å®¹
cat .dev.vars

# ç¢ºä¿æ ¼å¼æ­£ç¢ºï¼ˆKEY=VALUEï¼‰
```

### **æ•¸æ“šåº«éŒ¯èª¤ï¼Ÿ**

é€™æ˜¯æ­£å¸¸çš„ï¼Polling æ¨¡å¼ä½¿ç”¨ Mock æ•¸æ“šåº«ã€‚

å¦‚æœéœ€è¦æ¸¬è©¦æ•¸æ“šåº«åŠŸèƒ½ï¼š
- ç­‰ Cloudflare æ¢å¾©å¾Œä½¿ç”¨ `wrangler dev` + ngrok
- æˆ–ç›´æ¥éƒ¨ç½²åˆ° Staging ç’°å¢ƒæ¸¬è©¦

---

## ğŸ‰ **ç¸½çµ**

### âœ… **ä½ ç¾åœ¨å¯ä»¥ï¼š**

1. âœ… åœ¨æœ¬åœ°é–‹ç™¼å’Œæ¸¬è©¦ Bot
2. âœ… ä¸ä¾è³´ Cloudflare
3. âœ… å¿«é€Ÿè¿­ä»£é–‹ç™¼
4. âœ… æ¸¬è©¦æ–°åŠŸèƒ½
5. âœ… ä¿®å¾© Bug

### ğŸš€ **ç«‹å³é–‹å§‹ï¼š**

```bash
pnpm dev:polling
```

---

## ğŸ’¬ **éœ€è¦å¹«åŠ©ï¼Ÿ**

æŸ¥çœ‹ä»¥ä¸‹æ–‡æª”ï¼š

- `æœ¬åœ°é–‹ç™¼æŒ‡å—.md` - å®Œæ•´ä½¿ç”¨æŒ‡å—
- `æœ¬åœ°é–‹ç™¼ç’°å¢ƒå·²å°±ç·’.md` - é…ç½®èªªæ˜
- `LOCAL_DEV_QUICK_START.md` - å¿«é€Ÿé–‹å§‹

---

## ğŸŠ **Happy Coding!**

**ç¾åœ¨å°±é–‹å§‹é–‹ç™¼å§ï¼** ğŸš€

```bash
pnpm dev:polling
```

ä¸ç®¡ Cloudflare æ˜¯å¦å¯ç”¨ï¼Œä½ éƒ½å¯ä»¥ç¹¼çºŒé–‹ç™¼ï¼ğŸ’ª

---

**æœ€å¾Œæ›´æ–°ï¼š** 2025-01-18  
**ç‹€æ…‹ï¼š** âœ… æ¸¬è©¦é€šé  
**ä¸‹ä¸€æ­¥ï¼š** é–‹å§‹é–‹ç™¼ï¼

