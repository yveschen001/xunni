# XunNi 商業化檢查清單

## 1. 法律合規

### 1.1 條款與政策

- [ ] **使用者條款**（Terms of Service）
  - [ ] 服務使用規範
  - [ ] 使用者行為準則
  - [ ] 違規處罰機制
  - [ ] 免責聲明
  - [ ] 已通過法律顧問審核
  - [ ] 版本管理機制已實作

- [ ] **隱私權政策**（Privacy Policy）
  - [ ] 資料收集範圍說明
  - [ ] 資料使用目的說明
  - [ ] 資料保護措施說明
  - [ ] 使用者權利說明
  - [ ] 已通過法律顧問審核
  - [ ] 版本管理機制已實作

- [ ] **條款同意機制**
  - [ ] 註冊時必須同意條款
  - [ ] 必須先查看才能同意
  - [ ] 記錄同意時間和版本號
  - [ ] 重大更新時要求重新同意

### 1.2 年齡限制

- [ ] **18 歲驗證**
  - [ ] 註冊時驗證年齡（必須 >= 18）
  - [ ] 未滿 18 歲拒絕註冊
  - [ ] 友善提示「請成年後再來」
  - [ ] 生日輸入驗證（格式、合理性）

### 1.3 資料保護

- [ ] **GDPR 合規**（如適用）
  - [ ] 資料刪除權
  - [ ] 資料可攜權
  - [ ] 資料存取權

- [ ] **敏感資料保護**
  - [ ] 生日等敏感資訊加密存儲（可選）
  - [ ] 資料傳輸加密（HTTPS）
  - [ ] 資料庫存取控制

---

## 2. 使用者體驗

### 2.1 註冊流程

- [ ] **智能對話引導**
  - [ ] 俏皮、友好的對話風格
  - [ ] 清晰的步驟說明
  - [ ] 適當的鼓勵文字

- [ ] **中斷恢復**
  - [ ] 支援中斷後繼續
  - [ ] 保存進度到資料庫
  - [ ] 恢復時顯示進度

- [ ] **深度確認**
  - [ ] 性別設定需二次確認
  - [ ] 生日設定需二次確認
  - [ ] 明確提示「永遠不能修改」

### 2.2 關鍵資訊保護

- [ ] **不可修改欄位**
  - [ ] 性別：設定後永遠不能修改
  - [ ] 生日：設定後永遠不能修改
  - [ ] 資料庫層級限制（應用層 + 資料庫層）

- [ ] **修改限制實作**
  - [ ] `/profile` 編輯時隱藏性別、生日
  - [ ] API 層級驗證（拒絕修改請求）
  - [ ] 管理後台特殊權限（僅 god 可修改）

---

## 3. 功能完整性

### 3.1 核心功能

- [ ] **註冊流程**（10 步）
  - [ ] Step 0: 條款同意
  - [ ] Step 1: 暱稱 & 頭像
  - [ ] Step 2: 語言
  - [ ] Step 3: 性別（深度確認）
  - [ ] Step 4: 生日（年齡驗證 + 深度確認）
  - [ ] Step 5: 國家
  - [ ] Step 6: 喜好性向
  - [ ] Step 7: MBTI 測驗（支援中斷恢復）
  - [ ] Step 8: 反詐騙測驗（支援中斷恢復）
  - [ ] Step 9: 完成註冊

- [ ] **漂流瓶功能**
  - [ ] 丟瓶（含廣告、VIP 篩選）
  - [ ] 撿瓶（匹配邏輯）
  - [ ] 每日次數限制

- [ ] **匿名聊天**
  - [ ] 訊息轉發
  - [ ] 翻譯功能（VIP）
  - [ ] URL 白名單檢查
  - [ ] 每日訊息限制

- [ ] **VIP 訂閱**
  - [ ] Telegram Stars 支付
  - [ ] 自動續訂
  - [ ] 退款處理

- [ ] **管理後台**
  - [ ] 運營數據統計
  - [ ] 手動封禁/解封
  - [ ] 手動升級 VIP
  - [ ] 申訴審核

### 3.2 安全功能

- [ ] **風險管理**
  - [ ] 風險分數累積
  - [ ] 分級封禁機制
  - [ ] 舉報處理

- [ ] **內容審核**
  - [ ] URL 白名單
  - [ ] Emoji 驗證
  - [ ] AI 內容審核（可選）

---

## 4. 技術架構

### 4.1 資料庫

- [ ] **Schema 完整性**
  - [ ] 所有表已建立
  - [ ] 索引已優化
  - [ ] 遷移腳本完整

- [ ] **資料完整性**
  - [ ] 外鍵約束（如適用）
  - [ ] 唯一性約束
  - [ ] 非空約束

### 4.2 代碼品質

- [ ] **測試覆蓋率**
  - [ ] Domain 層：90%+
  - [ ] Utils：80%+
  - [ ] Handlers：60%+

- [ ] **代碼規範**
  - [ ] 遵循開發規範
  - [ ] TypeScript 嚴格模式
  - [ ] 無 linter 錯誤

### 4.3 部署與運維

- [ ] **環境配置**
  - [ ] Development 環境
  - [ ] Staging 環境
  - [ ] Production 環境

- [ ] **監控與日誌**
  - [ ] 錯誤日誌記錄
  - [ ] 性能監控
  - [ ] 告警機制

- [ ] **備份策略**
  - [ ] 代碼備份
  - [ ] 資料庫備份
  - [ ] 自動化備份

---

## 5. 商業化準備

### 5.1 支付系統

- [ ] **Telegram Stars 整合**
  - [ ] 支付流程完整
  - [ ] 支付成功處理
  - [ ] 退款處理
  - [ ] 訂閱管理

- [ ] **財務記錄**
  - [ ] 所有支付記錄
  - [ ] 收入統計
  - [ ] 退款統計

### 5.2 運營數據

- [ ] **數據統計**
  - [ ] 使用者數據
  - [ ] 收入數據
  - [ ] 使用數據
  - [ ] VIP 數據
  - [ ] 邀請數據

- [ ] **數據導出**
  - [ ] CSV 導出
  - [ ] JSON 導出
  - [ ] 定期報表

### 5.3 客戶支援

- [ ] **申訴機制**
  - [ ] 使用者可提交申訴
  - [ ] 管理員可審核申訴
  - [ ] 申訴處理記錄

- [ ] **幫助文檔**
  - [ ] `/help` 指令完整
  - [ ] 常見問題解答
  - [ ] 使用指南

---

## 6. 文檔完整性

### 6.1 技術文檔

- [ ] **規格文檔**
  - [ ] SPEC.md（完整）
  - [ ] ONBOARDING_FLOW.md（新增）
  - [ ] 所有功能模組文檔

- [ ] **開發文檔**
  - [ ] 開發規範
  - [ ] 模組設計
  - [ ] API 文檔

### 6.2 運營文檔

- [ ] **管理手冊**
  - [ ] 管理後台使用指南
  - [ ] 運營數據解讀
  - [ ] 常見問題處理

---

## 7. 上線前檢查

### 7.1 功能測試

- [ ] **完整流程測試**
  - [ ] 註冊流程（含中斷恢復）
  - [ ] 丟瓶/撿瓶流程
  - [ ] 聊天流程
  - [ ] VIP 購買流程

- [ ] **邊界條件測試**
  - [ ] 未滿 18 歲註冊
  - [ ] 性別/生日修改嘗試
  - [ ] 條款未同意註冊
  - [ ] 各種錯誤情況

### 7.2 性能測試

- [ ] **負載測試**
  - [ ] 並發使用者測試
  - [ ] 資料庫查詢優化
  - [ ] API 響應時間

### 7.3 安全測試

- [ ] **安全審計**
  - [ ] SQL 注入防護
  - [ ] XSS 防護
  - [ ] 敏感資訊保護
  - [ ] 權限驗證

---

## 8. 上線後監控

### 8.1 關鍵指標

- [ ] **使用者指標**
  - [ ] 註冊轉化率
  - [ ] 完成 onboarding 率
  - [ ] 日活躍使用者

- [ ] **業務指標**
  - [ ] VIP 轉化率
  - [ ] 月收入
  - [ ] 退款率

- [ ] **技術指標**
  - [ ] 錯誤率
  - [ ] 響應時間
  - [ ] 系統可用性

---

## 9. 持續改進

### 9.1 使用者反饋

- [ ] **反饋收集機制**
  - [ ] 使用者意見收集
  - [ ] 問題報告機制
  - [ ] 功能建議收集

### 9.2 迭代計劃

- [ ] **功能迭代**
  - [ ] 新功能規劃
  - [ ] 優化計劃
  - [ ] 技術債務處理

---

## 10. 多平台審查與 UI Guideline

> **詳細 UI 設計規範請參考**: `@doc/UI_GUIDELINE.md`

### 10.1 Google Play Material 3

- [ ] **UI 設計規範**
  - [ ] 遵循 Material Design 3 設計語言
  - [ ] 支援深色模式
  - [ ] 響應式佈局（手機、平板）
  - [ ] 無障礙設計（a11y）

- [ ] **審查交付物**
  - [ ] 應用圖標（512x512、1024x1024）
  - [ ] 宣傳圖片（至少 2 張）
  - [ ] 截圖（手機、7 吋平板、10 吋平板）
  - [ ] 演示影片（選填）
  - [ ] 隱私權政策 URL
  - [ ] 使用者條款 URL

- [ ] **功能要求**
  - [ ] 登入/註冊流程演示（截圖或影片）
  - [ ] 刪除帳號功能（設定頁面截圖）
  - [ ] 內容分級（PEGI/USK 等）
  - [ ] 目標年齡群（18+）

- [ ] **Data Safety**
  - [ ] Data Safety 表格填寫完整
  - [ ] 資料收集類型說明
  - [ ] 資料使用目的說明
  - [ ] 資料分享對象說明
  - [ ] 資料安全措施說明

### 10.2 App Store HIG (Human Interface Guidelines)

- [ ] **UI 設計規範**
  - [ ] 遵循 iOS Human Interface Guidelines
  - [ ] 支援深色模式
  - [ ] 適配 iPhone、iPad
  - [ ] 支援動態字體大小

- [ ] **審查交付物**
  - [ ] 應用圖標（1024x1024）
  - [ ] 宣傳圖片（至少 1 張）
  - [ ] 截圖（6.5 吋、6.7 吋 iPhone，12.9 吋 iPad）
  - [ ] 宣傳影片（選填）
  - [ ] 隱私權政策 URL
  - [ ] 使用者條款 URL

- [ ] **功能要求**
  - [ ] 登入/註冊流程演示（截圖或影片）
  - [ ] 刪除帳號功能（設定頁面截圖）
  - [ ] 內容分級（17+）
  - [ ] 年齡限制（17+）

- [ ] **App Privacy**
  - [ ] App Privacy 資訊填寫完整
  - [ ] 資料收集類型說明
  - [ ] 資料使用目的說明
  - [ ] 資料分享對象說明
  - [ ] 資料追蹤說明

### 10.3 Telegram Mini App

- [ ] **UI 設計規範**
  - [ ] 遵循 Telegram Mini App 設計指南
  - [ ] 支援深色模式（自動適配系統主題）
  - [ ] 響應式佈局
  - [ ] 使用 Telegram UI Kit（如適用）

- [ ] **審查交付物**
  - [ ] Mini App 截圖（至少 3 張）
  - [ ] 功能演示影片（選填）
  - [ ] Bot 簡介與說明
  - [ ] 隱私權政策 URL
  - [ ] 使用者條款 URL

- [ ] **功能要求**
  - [ ] 登入流程演示（initData 驗簽）
  - [ ] 刪除帳號功能
  - [ ] WebApp.share Deep Link 支援
  - [ ] 首屏載入 < 2 秒

- [ ] **內容授權**
  - [ ] 內容符合 Telegram 使用條款
  - [ ] 不包含違規內容
  - [ ] 年齡限制（18+）

### 10.4 WeChat Mini Program / Official Account

- [ ] **審查交付物**
  - [ ] 應用名稱、簡介、類別
  - [ ] 應用圖標、啟動頁面
  - [ ] 功能截圖（至少 5 張）
  - [ ] 使用流程影片
  - [ ] 營業執照（如適用）
  - [ ] ICP 備案號（如適用）

- [ ] **功能要求**
  - [ ] 登入流程演示（WeChat 授權）
  - [ ] 刪除帳號功能
  - [ ] 內容合規性檢查
  - [ ] 支付功能（如適用）

### 10.5 Line Bot / LIFF App

- [ ] **審查交付物**
  - [ ] Bot 名稱、簡介、圖標
  - [ ] 功能截圖（至少 3 張）
  - [ ] 使用流程說明
  - [ ] 隱私權政策 URL
  - [ ] 使用者條款 URL

- [ ] **功能要求**
  - [ ] 登入流程演示（Line 授權）
  - [ ] 刪除帳號功能
  - [ ] Line Official Account 申請
  - [ ] 內容合規性檢查

### 10.6 內容授權說明

- [ ] **翻譯供應商說明**
  - [ ] 使用 Google Translate API（免費使用者）
  - [ ] 使用 OpenAI GPT-4o-mini（VIP 使用者）
  - [ ] 失敗時自動降級到 Google Translate
  - [ ] 翻譯內容僅用於對話，不儲存

- [ ] **資料處理說明**
  - [ ] 資料收集範圍
  - [ ] 資料使用目的
  - [ ] 資料保護措施
  - [ ] 資料分享對象

### 10.7 WebApp.share 分享功能

- [ ] **分享功能**
  - [ ] 支援分享到 Telegram
  - [ ] Deep Link 格式：`startapp=share_mbti_{resultId}`
  - [ ] 分享文案與預覽圖片
  - [ ] 追蹤分享來源

- [ ] **埋點要求**
  - [ ] `POST /api/tests/:slug/share` 埋點
  - [ ] 記錄分享來源、時間、使用者 ID
  - [ ] 分析分享轉化率

---

## 檢查清單使用說明

1. **開發階段**：按照清單逐項完成
2. **上線前**：完整檢查所有項目
3. **上線後**：定期檢查監控指標
4. **持續改進**：根據使用者反饋更新清單

---

**最後更新**: 2025-01-15  
**版本**: 2.0

