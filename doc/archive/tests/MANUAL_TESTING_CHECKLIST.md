# 擬人測試驗證清單

**測試時間：** 2025-01-16  
**Bot：** @xunni_dev_bot  
**Version ID：** ce70d920-4451-4b62-9d1f-8a98344b3663  
**測試人員：** AI Assistant

---

## 🎯 測試目標

### 1. 測試完整的漂流瓶流程
- [ ] 丟瓶子
- [ ] 撿瓶子
- [ ] 對話

### 2. 驗證暱稱顯示
- [ ] 撿瓶子時的暱稱顯示
- [ ] 對話訊息中的暱稱顯示
- [ ] 確認是部分暱稱 + `****`，不是全部 `****`

---

## 📋 測試步驟

### 準備工作

#### 用戶 A（主測試帳號）
- Telegram ID: [待填寫]
- 暱稱: `OKOk`（4 字符）
- 預期遮蓋: `OKOk******`（4 + 6 = 10）

#### 用戶 B（協助測試帳號）
- Telegram ID: [待填寫]
- 暱稱: `測試用戶`（4 字符）
- 預期遮蓋: `測試用戶****`（4 + 6 = 10）

---

## 🧪 測試場景 1：丟瓶子流程

### 步驟 1：用戶 A 丟瓶子

**操作：**
```
1. 發送：/dev_reset（清空數據）
2. 發送：/dev_skip（快速設置）
3. 發送：/throw
4. 輸入瓶子內容：「試試啊啊試試啊啊試試啊啊」（12+ 字符）
```

**預期結果：**
```
🎉 漂流瓶已丟出！

瓶子 ID：#[數字]
今日已丟：1/3

💡 你的瓶子將在 24 小時內等待有緣人撿起～

想要撿別人的瓶子嗎？使用 /catch
```

**實際結果：**
- [ ] ✅ 瓶子成功丟出
- [ ] ✅ 顯示瓶子 ID
- [ ] ✅ 顯示今日配額

**問題記錄：**
```
[如有問題，記錄在此]
```

---

## 🧪 測試場景 2：撿瓶子流程

### 步驟 2：用戶 B 撿瓶子

**操作：**
```
1. 切換到用戶 B
2. 發送：/dev_reset（清空數據）
3. 發送：/dev_skip（快速設置）
4. 發送：/catch
```

**預期結果：**
```
🎉 OKOk 撿到你的漂流瓶了！

📨 暱稱：OKOk******
🧠 MBTI：[MBTI]
⭐ 星座：[星座]
♀ 女 | 📅 [年齡]歲

已為你們建立了匿名對話，快來開始聊天吧～

💬 直接回覆訊息即可開始對話

🔒 需要封鎖或舉報請直接在此對話中使用 /block 或 /report
🏠 返回主選單：/menu
```

**關鍵驗證點：**
- [ ] ✅ 暱稱顯示為 `OKOk******`（不是 `****`）
- [ ] ✅ 顯示 MBTI 和星座
- [ ] ✅ 顯示性別和年齡
- [ ] ✅ 提示可以開始對話

**實際結果：**
```
暱稱顯示：[實際顯示內容]
```

**問題記錄：**
```
[如有問題，記錄在此]
```

---

## 🧪 測試場景 3：對話流程

### 步驟 3：用戶 B 發送訊息

**操作：**
```
1. 用戶 B 直接輸入：「你好啊」
```

**預期結果（用戶 A 收到）：**
```
💬 來自匿名對話的訊息（來自 #A）：
來自：測試用戶****
MBTI：[MBTI]
星座：[星座]

你好啊

⚠️ 長按對方訊息，在子菜單中選擇"reply"，系統才會送出匿名聊天。

🔒 需要封鎖或舉報請直接在此對話中使用 /block 或 /report
🏠 返回主選單：/menu
```

**關鍵驗證點：**
- [ ] ✅ 暱稱顯示為 `測試用戶****`（不是 `****`）
- [ ] ✅ 顯示對話標識符（#A）
- [ ] ✅ 顯示 MBTI 和星座
- [ ] ✅ 顯示訊息內容
- [ ] ✅ 顯示 reply 提示

**實際結果：**
```
暱稱顯示：[實際顯示內容]
標識符：[實際標識符]
```

**問題記錄：**
```
[如有問題，記錄在此]
```

---

### 步驟 4：用戶 A 回覆訊息

**操作：**
```
1. 用戶 A 直接輸入：「你好你好」
```

**預期結果（用戶 B 收到）：**
```
💬 來自匿名對話的訊息（來自 #B）：
來自：OKOk******
MBTI：[MBTI]
星座：[星座]

你好你好

⚠️ 長按對方訊息，在子菜單中選擇"reply"，系統才會送出匿名聊天。

🔒 需要封鎖或舉報請直接在此對話中使用 /block 或 /report
🏠 返回主選單：/menu
```

**關鍵驗證點：**
- [ ] ✅ 暱稱顯示為 `OKOk******`（不是 `****`）
- [ ] ✅ 顯示對話標識符（#B）
- [ ] ✅ 顯示訊息內容

**實際結果：**
```
暱稱顯示：[實際顯示內容]
標識符：[實際標識符]
```

**問題記錄：**
```
[如有問題，記錄在此]
```

---

## 🧪 測試場景 4：不同長度暱稱

### 測試 4.1：短暱稱（1-3 字符）

**測試暱稱：** `張`（1 字符）

**預期遮蓋：** `張*********`（1 + 9 = 10）

**實際結果：**
```
[待測試]
```

---

### 測試 4.2：中等暱稱（4-6 字符）

**測試暱稱：** `Alice`（5 字符）

**預期遮蓋：** `Alice*****`（5 + 5 = 10）

**實際結果：**
```
[待測試]
```

---

### 測試 4.3：長暱稱（7+ 字符）

**測試暱稱：** `Alexander`（9 字符）

**預期遮蓋：** `Alexan****`（6 + 4 = 10）

**實際結果：**
```
[待測試]
```

---

## 📊 測試總結

### 通過的測試
- [ ] 丟瓶子流程
- [ ] 撿瓶子流程
- [ ] 對話流程
- [ ] 暱稱遮蓋規則（10 字符）
- [ ] 對話標識符顯示

### 失敗的測試
```
[列出失敗的測試項目]
```

### 發現的問題
```
[列出發現的問題]
```

### 需要修復的項目
```
[列出需要修復的項目]
```

---

## 🔍 Cloudflare 日誌檢查

### 檢查項目
- [ ] 檢查 `/throw` 的日誌
- [ ] 檢查 `/catch` 的日誌
- [ ] 檢查訊息轉發的日誌
- [ ] 檢查是否有錯誤訊息

### 日誌記錄
```
[記錄關鍵日誌]
```

---

## ✅ 驗收標準

### 必須通過的項目
1. ✅ 丟瓶子成功，顯示瓶子 ID
2. ✅ 撿瓶子成功，暱稱顯示為 `暱稱前綴****`（不是全部 `****`）
3. ✅ 對話訊息正確轉發
4. ✅ 對話訊息中暱稱顯示為 `暱稱前綴****`
5. ✅ 對話標識符正確顯示（#A, #B）
6. ✅ 所有暱稱遮蓋都是 10 字符格式

### 可選項目
- [ ] 測試不同長度暱稱的遮蓋效果
- [ ] 測試 `/history` 命令
- [ ] 測試 `/profile` 命令

---

## 🙏 測試結論

**狀態：** [待測試]

**結論：**
```
[測試完成後填寫]
```

**下一步：**
```
[測試完成後填寫]
```

---

**⚠️ 重要提醒：這是擬人測試清單，需要實際操作 Bot 進行驗證！**

