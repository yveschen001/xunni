# XunNi i18n ç³»ç»Ÿå®ç°æŠ¥å‘Š

> **çŠ¶æ€**: âœ… Phase 1 å®Œæˆ  
> **æ—¥æœŸ**: 2025-01-15  
> **éƒ¨ç½²**: Staging ç¯å¢ƒå·²æ›´æ–°

---

## âœ… å®Œæˆå†…å®¹

### 1. i18n ç³»ç»Ÿæ ¸å¿ƒ âœ…

**æ–‡ä»¶ç»“æ„**:
```
src/i18n/
â”œâ”€â”€ index.ts              # i18n æ ¸å¿ƒï¼ˆç¿»è¯‘åŠ è½½ã€ç¼“å­˜ã€Fallbackï¼‰
â”œâ”€â”€ types.ts              # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ languages.ts          # è¯­è¨€åˆ—è¡¨å’Œå·¥å…·å‡½æ•°
â””â”€â”€ locales/
    â”œâ”€â”€ zh-TW.ts          # ç¹ä½“ä¸­æ–‡ï¼ˆ100% å®Œæˆï¼‰
    â”œâ”€â”€ en.ts             # è‹±æ–‡ï¼ˆ100% å®Œæˆï¼‰
    â””â”€â”€ template.ts       # å…¶ä»–è¯­è¨€å ä½
```

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… ç¿»è¯‘åŠ è½½å’Œç¼“å­˜
- âœ… Fallback æœºåˆ¶ï¼ˆzh-TW é»˜è®¤ï¼‰
- âœ… å‚æ•°æ›¿æ¢ï¼ˆ`{paramName}` è¯­æ³•ï¼‰
- âœ… TypeScript ç±»å‹å®‰å…¨
- âœ… åµŒå¥— Key æ”¯æŒï¼ˆ`onboarding.welcome`ï¼‰

---

### 2. å®Œæ•´ç¿»è¯‘å®ç° âœ…

#### ç¹ä½“ä¸­æ–‡ (zh-TW) - 100% âœ…
- âœ… 66+ ç¿»è¯‘ Key
- âœ… æ‰€æœ‰ç±»åˆ«å®Œæ•´è¦†ç›–
- âœ… å‚æ•°åŒ–æ”¯æŒ

#### è‹±æ–‡ (en) - 100% âœ…
- âœ… 66+ ç¿»è¯‘ Key
- âœ… æ‰€æœ‰ç±»åˆ«å®Œæ•´è¦†ç›–
- âœ… å‚æ•°åŒ–æ”¯æŒ

#### å…¶ä»– 18 ç§è¯­è¨€ - å ä½ â³
- ğŸ‡¨ğŸ‡³ ç®€ä½“ä¸­æ–‡ (zh-CN)
- ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª (ja)
- ğŸ‡°ğŸ‡· í•œêµ­ì–´ (ko)
- ğŸ‡¹ğŸ‡­ à¸ à¸²à¸©à¸²à¹„à¸—à¸¢ (th)
- ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t (vi)
- ğŸ‡®ğŸ‡© Bahasa Indonesia (id)
- ğŸ‡²ğŸ‡¾ Bahasa Melayu (ms)
- ğŸ‡µğŸ‡­ Filipino (tl)
- ğŸ‡ªğŸ‡¸ EspaÃ±ol (es)
- ğŸ‡µğŸ‡¹ PortuguÃªs (pt)
- ğŸ‡«ğŸ‡· FranÃ§ais (fr)
- ğŸ‡©ğŸ‡ª Deutsch (de)
- ğŸ‡®ğŸ‡¹ Italiano (it)
- ğŸ‡·ğŸ‡º Ğ ÑƒÑÑĞºĞ¸Ğ¹ (ru)
- ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (ar)
- ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤¨à¥à¤¦à¥€ (hi)
- ğŸ‡§ğŸ‡© à¦¬à¦¾à¦‚à¦²à¦¾ (bn)
- ğŸ‡¹ğŸ‡· TÃ¼rkÃ§e (tr)

**å ä½ç­–ç•¥**: ä½¿ç”¨ key + zh-TW fallbackï¼Œæœªæ¥ä» CSV/Google Sheets å¯¼å…¥

---

### 3. ç¿»è¯‘å†…å®¹ç±»åˆ« âœ…

| ç±»åˆ« | Key æ•°é‡ | è¯´æ˜ |
|------|----------|------|
| Common | 11 | é€šç”¨è¯æ±‡ï¼ˆæ˜¯/å¦/å–æ¶ˆ/ç¡®è®¤ç­‰ï¼‰ |
| Onboarding | 15 | æ³¨å†Œæµç¨‹ï¼ˆæ¬¢è¿/æ˜µç§°/æ€§åˆ«/ç”Ÿæ—¥/MBTI/åè¯ˆéª—/æ¡æ¬¾ï¼‰ |
| Commands | 11 | å‘½ä»¤åˆ—è¡¨ï¼ˆ/start, /help, /throw, /catch ç­‰ï¼‰ |
| Help | 3 | å¸®åŠ©ä¿¡æ¯ |
| Bottle | 8 | æ¼‚æµç“¶åŠŸèƒ½ï¼ˆä¸¢ç“¶/æ¡ç“¶/æ¥å—/æ‹’ç»ï¼‰ |
| Profile | 8 | ä¸ªäººèµ„æ–™ï¼ˆæ˜µç§°/æ€§åˆ«/å¹´é¾„/æ˜Ÿåº§/MBTI/è¯­è¨€/VIPï¼‰ |
| VIP | 5 | VIP è®¢é˜…ï¼ˆæƒç›Š/ä»·æ ¼/è®¢é˜…/å·²è®¢é˜…/è¿‡æœŸï¼‰ |
| Errors | 5 | é”™è¯¯æ¶ˆæ¯ï¼ˆé€šç”¨/æœªæ³¨å†Œ/å·²å°ç¦/æ— æ•ˆè¾“å…¥/ç½‘ç»œé”™è¯¯ï¼‰ |
| **æ€»è®¡** | **~66** | - |

---

### 4. ä½¿ç”¨ç¤ºä¾‹ âœ…

#### ç®€å•ç¿»è¯‘
```typescript
import { createI18n } from '~/i18n';

const i18n = createI18n(user.language_pref);

// ç®€å•ç¿»è¯‘
await telegram.sendMessage(
  chatId,
  i18n.t('onboarding.welcome')
);
```

#### å‚æ•°åŒ–ç¿»è¯‘
```typescript
// å¸¦å‚æ•°çš„ç¿»è¯‘
await telegram.sendMessage(
  chatId,
  i18n.t('onboarding.profileSummary', {
    nickname: user.nickname,
    gender: user.gender,
    age: user.age,
    zodiac: user.zodiac_sign,
    mbti: user.mbti_result,
  })
);
```

#### å·²é›†æˆçš„ Handler
- âœ… `language_selection.ts` - è¯­è¨€é€‰æ‹©æµç¨‹

---

### 5. Fallback æœºåˆ¶ âœ…

**ä¼˜å…ˆçº§**:
1. **ç²¾ç¡®åŒ¹é…**: `zh-TW` â†’ `zh-TW.ts` âœ…
2. **è¯­è¨€åŒ¹é…**: `zh-CN` â†’ `zh` (å¦‚æœå­˜åœ¨)
3. **é»˜è®¤è¯­è¨€**: æ‰€æœ‰æœªåŒ¹é… â†’ `zh-TW` âœ…

**ç¤ºä¾‹**:
```typescript
// ç”¨æˆ·é€‰æ‹© ja (æ—¥æœ¬èª)
getTranslations('ja')
// â†’ æ£€æŸ¥ ja.ts (ä¸å­˜åœ¨)
// â†’ è¿”å› zh-TW.ts (fallback) âœ…

// ç”¨æˆ·é€‰æ‹© en (English)
getTranslations('en')
// â†’ æ£€æŸ¥ en.ts (å­˜åœ¨)
// â†’ è¿”å› en.ts âœ…
```

---

### 6. æµ‹è¯•ç»“æœ âœ…

#### TypeScript æ£€æŸ¥
```
âœ… é€šè¿‡ - æ— ç±»å‹é”™è¯¯
```

#### ESLint æ£€æŸ¥
```
âœ… é€šè¿‡ - 0 é”™è¯¯ï¼Œ9 è­¦å‘Šï¼ˆå¯æ¥å—ï¼‰
```

#### Onboarding æµç¨‹æµ‹è¯•
```
âœ… 8/8 æ­¥éª¤é€šè¿‡
âœ… i18n ç³»ç»Ÿæ­£å¸¸å·¥ä½œ
âœ… è¯­è¨€é€‰æ‹©åŠŸèƒ½æ­£å¸¸
âœ… ç¿»è¯‘æ˜¾ç¤ºæ­£ç¡®
```

#### éƒ¨ç½²çŠ¶æ€
```
âœ… Staging ç¯å¢ƒå·²æ›´æ–°
âœ… Worker ç‰ˆæœ¬: 02537bed-f496-4e86-84f8-69854d5c4a1d
âœ… URL: https://xunni-bot-staging.yves221.workers.dev
```

---

## ğŸš€ æœªæ¥æ‰©å±•

### Phase 2: CSV/Google Sheets å¯¼å…¥ â³

#### CSV æ ¼å¼ç¤ºä¾‹
```csv
key,zh-TW,en,ja,ko,th,vi,...
common.yes,æ˜¯,Yes,ã¯ã„,ì˜ˆ,à¹ƒà¸Šà¹ˆ,CÃ³,...
common.no,å¦,No,ã„ã„ãˆ,ì•„ë‹ˆìš”,à¹„à¸¡à¹ˆ,KhÃ´ng,...
onboarding.welcome,æ­¡è¿ä¾†åˆ° XunNiï¼,Welcome to XunNi!,XunNiã¸ã‚ˆã†ã“ãï¼,...
```

#### å¯¼å…¥åŠŸèƒ½
```typescript
// æœªæ¥å®ç°
await loadExternalTranslations('ja', 'google-sheets', SHEET_URL);
```

#### ä¼˜åŠ¿
- ğŸŒ éæŠ€æœ¯äººå‘˜å¯ä»¥ç¿»è¯‘
- ğŸ“Š é›†ä¸­ç®¡ç†æ‰€æœ‰ç¿»è¯‘
- ğŸ”„ è‡ªåŠ¨åŒæ­¥ï¼Œæ— éœ€é‡æ–°éƒ¨ç½²
- ğŸ‘¥ æ”¯æŒç¤¾åŒºè´¡çŒ®

---

## ğŸ“Š é¡¹ç›®è¿›åº¦

### Phase 1: Bot åŸºç¡€åŠŸèƒ½ï¼ˆè¿›è¡Œä¸­ï¼‰
- âœ… è¯­è¨€é€‰æ‹©åŠŸèƒ½
- âœ… è‡ªåŠ¨è§¦å‘æ¬¢è¿
- âœ… i18n ç³»ç»Ÿï¼ˆzh-TW + enï¼‰
- â³ åœ¨æ‰€æœ‰ Handler ä¸­ä½¿ç”¨ i18n
- â³ ä¼˜åŒ–æ³¨å†Œæµç¨‹

### Phase 2: Mini Appï¼ˆæœªæ¥ï¼‰
- â³ Mini App æ³¨å†Œæµç¨‹
- â³ Bot å¼•å¯¼åˆ° Mini App
- â³ åŒé“¾è·¯åŒæ­¥

---

## ğŸ¯ æŒ‰ç…§è¦æ±‚å®Œæˆ

âœ… **å…ˆå®Œæˆä¸­æ–‡ç¹ä½“å’Œè‹±æ–‡** - å·²å®Œæˆ  
âœ… **å…¶ä»–è¯­è¨€ç”¨ key + ä¸­æ–‡ç¹ä½“å ä½** - å·²å®Œæˆ  
âœ… **æ—¥åç”¨ CSV/Google Sheets ç¿»è¯‘** - å·²é¢„ç•™æ¥å£  

---

## ğŸ“ æ–‡æ¡£

- âœ… `doc/I18N_IMPLEMENTATION.md` - å®Œæ•´å®ç°æ–‡æ¡£
- âœ… `doc/I18N_GUIDE.md` - ä½¿ç”¨æŒ‡å—ï¼ˆå·²å­˜åœ¨ï¼‰
- âœ… `doc/SPEC.md` - é¡¹ç›®è§„æ ¼ï¼ˆå·²æ›´æ–°ï¼‰

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### ç¿»è¯‘ Key ç»“æ„
```typescript
// é€šç”¨
common.yes
common.no
common.cancel

// Onboarding
onboarding.welcome
onboarding.askNickname
onboarding.askGender

// å‘½ä»¤
commands.start
commands.help
commands.throw

// é”™è¯¯
errors.generic
errors.notRegistered
errors.banned
```

### å‚æ•°æ›¿æ¢
```typescript
// ç¿»è¯‘æ–‡æœ¬
"ä½ çš„å¹´é¾„æ˜¯ {age} å²"

// ä½¿ç”¨
i18n.t('profile.age', { age: 25 })
// è¾“å‡º: "ä½ çš„å¹´é¾„æ˜¯ 25 å²"
```

---

## ğŸ‰ æ€»ç»“

### å·²å®Œæˆ
1. âœ… å®Œæ•´çš„ i18n ç³»ç»Ÿæ¶æ„
2. âœ… zh-TW å’Œ en 100% å®Œæˆ
3. âœ… 18 ç§è¯­è¨€å ä½ï¼ˆä½¿ç”¨ fallbackï¼‰
4. âœ… TypeScript ç±»å‹å®‰å…¨
5. âœ… å‚æ•°åŒ–ç¿»è¯‘æ”¯æŒ
6. âœ… Fallback æœºåˆ¶
7. âœ… é›†æˆåˆ° language_selection handler
8. âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡
9. âœ… éƒ¨ç½²åˆ° Staging

### ä¸‹ä¸€æ­¥
1. â³ åœ¨æ‰€æœ‰ Handler ä¸­ä½¿ç”¨ i18nï¼ˆthrow, catch, profile, help ç­‰ï¼‰
2. â³ ä¼˜åŒ– Bot æ³¨å†Œæµç¨‹ä½“éªŒ
3. â³ å®ç° CSV/Google Sheets å¯¼å…¥ï¼ˆPhase 2ï¼‰

---

**ç»´æŠ¤è€…**: XunNi Team  
**æœ€åæ›´æ–°**: 2025-01-15  
**ç‰ˆæœ¬**: 1.0.0  
**çŠ¶æ€**: âœ… Phase 1 å®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•

